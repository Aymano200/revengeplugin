(function(l,r,d,u,n,o,E,i){"use strict";const{View:S,ScrollView:f}=r.ReactNative;function h(){return E.useProxy(o.storage),r.React.createElement(f,null,r.React.createElement(S,null,r.React.createElement(i.Forms.FormSwitchRow,{label:"Remove blocked messages",value:o.storage.blocked??!0,onValueChange:function(e){return o.storage.blocked=e},note:""}),r.React.createElement(i.Forms.FormSwitchRow,{label:"Remove ignored messages",value:o.storage.ignored??!0,onValueChange:function(e){return o.storage.ignored=e},note:""}),r.React.createElement(i.Forms.FormSwitchRow,{label:"Remove replies to blocked/ignored users",value:o.storage.removeReplies??!0,onValueChange:function(e){return o.storage.removeReplies=e},note:"Filters messages replying to blocked or ignored users."})))}const R=u.findByName("RowManager"),{isBlocked:v,isIgnored:p}=u.findByProps("isBlocked","isIgnored"),s="HideBlockedAndIgnoredMessages";function y(e,g){let t={id:"",type:0,content:"",channel_id:g.id,author:{id:"",username:"",avatar:"",discriminator:"",publicFlags:0,avatarDecoration:null},attachments:[],embeds:[],mentions:[],mention_roles:[],pinned:!1,mention_everyone:!1,tts:!1,timestamp:"",edited_timestamp:null,flags:0,components:[]};return typeof e=="string"?t.content=e:t={...t,...e},t}const m=function(e){return e?!!(o.storage.blocked&&v(e)||o.storage.ignored&&p(e)):!1},c=function(e){return e?!!(m(e.author?.id)||o.storage.removeReplies&&e.referenced_message&&m(e.referenced_message.author?.id)):!1};let a=[];const A=function(){try{const e=d.before("dispatch",r.FluxDispatcher,function([t]){t.type==="LOAD_MESSAGES_SUCCESS"&&(t.messages=t.messages.filter(function(C){return!c(C)})),(t.type==="MESSAGE_CREATE"||t.type==="MESSAGE_UPDATE")&&c(t.message)&&(t.channelId="0")});a.push(e);const g=d.before("generate",R.prototype,function([t]){c(t.message)&&(t.renderContentOnly=!0,t.message.content=null,t.message.reactions=[],t.message.canShowComponents=!1,t.rowType===2&&(t.roleStyle="",t.text="[Filtered message. Check plugin settings.]",t.revealed=!1,t.content=[]))});a.push(g),n.logger.log(`${s} loaded.`)}catch(e){n.logger.error(`[${s} Error]`,e)}};var b={onLoad:function(){n.logger.log(`Loading ${s}...`),o.storage.blocked??=!0,o.storage.ignored??=!0,o.storage.removeReplies??=!0;for(let e of["MESSAGE_CREATE","MESSAGE_UPDATE","LOAD_MESSAGES","LOAD_MESSAGES_SUCCESS"])n.logger.log(`Dispatching ${e} to enable handler.`),r.FluxDispatcher.dispatch({type:e,message:y("PLACEHOLDER",{id:"0"}),messages:[]});A()},onUnload:function(){n.logger.log(`Unloading ${s}...`);for(let e of a)e();a=[],n.logger.log(`${s} unloaded.`)},settings:h};return l.default=b,Object.defineProperty(l,"__esModule",{value:!0}),l})({},vendetta.metro.common,vendetta.patcher,vendetta.metro,vendetta,vendetta.plugin,vendetta.storage,vendetta.ui.components);
