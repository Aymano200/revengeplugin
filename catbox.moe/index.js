(function(s,C,d,l,c,i,y,g,p){"use strict";function x(e,t=2){if(!+e)return"0 Bytes";const r=1024,a=t<0?0:t,o=["Bytes","KB","MB","GB","TB"],m=Math.floor(Math.log(e)/Math.log(r));return`${parseFloat((e/Math.pow(r,m)).toFixed(a))} ${o[m]}`}const{NativeModules:u}=l.ReactNative;u.NativeFileModule??u.RTNFileManager??u.DCDFileManager;async function b(e){try{console.log("[CatboxUploader] Media object:",e);const t=e?.item?.originalUri||e?.uri||e?.fileUri||e?.path||e?.sourceURL;if(!t)throw new Error("Missing file URI");const r=i.storage.userhash?.trim(),a=new FormData;a.append("reqtype","fileupload"),r&&a.append("userhash",r),a.append("fileToUpload",{uri:t,name:e.filename??"upload",type:e.mimeType??"application/octet-stream"});const o=await(await fetch("https://catbox.moe/user/api.php",{method:"POST",body:a})).text();if(console.log("[CatboxUploader] Raw response:",o),!o.startsWith("https://"))throw new Error(o);return o}catch(t){return console.error("[CatboxUploader] Upload failed:",t),null}}const{FormInput:U,FormDivider:v}=y.Forms;function f(){return g.useProxy(i.storage),React.createElement(l.ReactNative.ScrollView,{style:{flex:1}},React.createElement(U,{title:"Catbox Userhash",placeholder:"Required for uploads to own user account",value:i.storage.userhash||"",onChange:function(e){return i.storage.userhash=e.trim()},helpText:i.storage.userhash?null:React.createElement(l.ReactNative.Text,{style:{color:"#989898"}},"Optional")}),React.createElement(v,null))}const n=d.findByProps("show","confirm","close"),w=d.findByProps("CloudUpload")?.CloudUpload;let h=[];var T={onLoad(){h.push(C.before("reactNativeCompressAndExtractData",w.prototype,function(){const e=this,t=e?.preCompressionSize,r=x(t),a=i.storage.userhash?.trim();if(console.log("[CatboxUploader] Hook triggered! File size:",r),t>10*1024*1024)return a?c.showToast(`Uploading ${r} file to Catbox...`,p.getAssetIDByName("ic_file_upload_24px")):c.showToast(`Uploading ${r} file to Catbox anonymously...`,p.getAssetIDByName("ic_file_upload_24px")),b(e).then(function(o){o?n.show({title:"Upload Successful",body:`Here\u2019s your file link:
${o}`,confirmText:"Copy Link",cancelText:"Close",confirmColor:"brand",onConfirm:function(){l.ReactNative.Clipboard.setString(o),c.showToast("Copied to clipboard!","success"),n.close()},onCancel:function(){return n.close()}}):n.show({title:"Upload Failed",body:"Could not upload the file to catbox.moe. Please try again later.",confirmText:"OK",confirmColor:"red",onConfirm:function(){return n.close()}})}).catch(function(o){console.error("[CatboxUploader] Upload error:",o),n.show({title:"Upload Error",body:"An unexpected error occurred during upload.",confirmText:"OK",confirmColor:"red",onConfirm:function(){return n.close()}})}),[]})),this.settings=f},onUnload(){h.forEach(function(e){return e()})},settings:f};return s.default=T,Object.defineProperty(s,"__esModule",{value:!0}),s})({},vendetta.patcher,vendetta.metro,vendetta.metro.common,vendetta.ui.toasts,vendetta.plugin,vendetta.ui.components,vendetta.storage,vendetta.ui.assets);
